<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TenaBot DEBUG</title>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <style>
        body {
            /* HIGH VISIBILITY fallback background */
            background-color: #FFC0CB; /* Pink */
            margin: 0;
            padding: 20px;
            font-family: sans-serif;
            color: black;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        h1 { color: black; }
    </style>
</head>
<body>
    <h1>TenaBot Debug: Initializing...</h1>
    <p id="status-message">Attempting to load WebApp API and Debugger...</p>
    <div id="debug-info"></div>

    <script src="https://cdn.jsdelivr.net/npm/eruda"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const statusMsg = document.getElementById('status-message');
            const debugInfo = document.getElementById('debug-info');

            // --- 1. Initialize Eruda safely (Wait for it to load) ---
            if (window.eruda) {
                eruda.init();
                statusMsg.innerHTML += '<br>✅ **Eruda Console Initialized** (Check bottom right icon)';
            } else {
                statusMsg.innerHTML += '<br>⚠️ **Eruda Failed to Load** (Possible Content Security Policy block)';
            }

            // --- 2. Check Telegram WebApp API ---
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.ready(); 
                
                // Change background to prove API is working and to match Telegram theme
                const bgColor = window.Telegram.WebApp.themeParams.bg_color || '#212122';
                document.body.style.backgroundColor = bgColor;
                document.body.style.color = window.Telegram.WebApp.themeParams.text_color || 'white';
                
                debugInfo.innerHTML += `
                    <p style="color: green;">✅ **Web App API Status: READY**</p>
                    <p>Background color should be a Telegram dark theme color.</p>
                `;

                if (window.eruda) {
                    eruda.console.log('--- Telegram WebApp Success ---');
                    eruda.console.log('User Data:', window.Telegram.WebApp.initDataUnsafe.user);
                }

            } else {
                // If this message appears on mobile, the core Web App connection failed
                debugInfo.innerHTML += '<p style="color: red;">❌ **Web App API Status: FAILED** (window.Telegram.WebApp is undefined)</p>';
                if (window.eruda) {
                    eruda.console.log('--- Telegram WebApp Failure ---');
                }
            }
            
            statusMsg.innerHTML = '<h1>TenaBot Debug: Complete</h1>';
        });
    </script>
</body>
</html>