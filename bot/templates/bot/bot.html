<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TenaBot Mini App</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Telegram Web App Script -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* Set the background to match Telegram's default dark mode color for a cleaner look */
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--tg-theme-bg-color, #212121);
            color: var(--tg-theme-text-color, #FFFFFF);
            transition: background-color 0.3s, color 0.3s;
        }
        /* Style the main button using Telegram's theme colors */
        .tg-button {
            background-color: var(--tg-theme-button-color, #5E62F4);
            color: var(--tg-theme-button-text-color, #FFFFFF);
            border: none;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
        .tg-button:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        .info-box {
            background-color: var(--tg-theme-secondary-bg-color, #333333);
            border-left: 4px solid var(--tg-theme-accent-text-color, #5E62F4);
        }
    </style>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
  const tg = window.Telegram.WebApp;
  tg.expand(); // optional: expands the app to full height
  console.log("Telegram Mini App initialized");
</script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Custom colors based on Telegram WebApp variables
                        'tg-bg': 'var(--tg-theme-bg-color, #212121)',
                        'tg-secondary-bg': 'var(--tg-theme-secondary-bg-color, #333333)',
                        'tg-text': 'var(--tg-theme-text-color, #FFFFFF)',
                        'tg-hint': 'var(--tg-theme-hint-color, #AAAAAA)',
                        'tg-button': 'var(--tg-theme-button-color, #5E62F4)',
                        'tg-button-text': 'var(--tg-theme-button-text-color, #FFFFFF)',
                    }
                }
            }
        }
    </script>
</head>
<body class="p-6 h-screen flex flex-col items-center justify-center">

    <div class="max-w-md w-full p-6 rounded-xl shadow-2xl bg-tg-secondary-bg">
        <h1 class="text-2xl font-bold text-tg-text mb-4">TenaBot Mini App</h1>
        <p class="text-tg-hint mb-6">
            This app is running inside your Telegram client. Press the button to send data and close the window.
        </p>

        <!-- Information Box -->
        <div class="info-box p-4 rounded-lg mb-6">
            <h2 class="text-lg font-semibold text-tg-text">Web App Data</h2>
            <p class="text-sm text-tg-hint mt-1" id="tg-init-data">
                Loading initialization data...
            </p>
        </div>

        <!-- Submit Button -->
        <button id="sendDataButton" class="tg-button w-full py-3 rounded-lg font-semibold text-lg hover:opacity-90">
            Send Mock Data to Bot
        </button>
    </div>

    <script>
        // Check if the Telegram WebApp object is available
        if (window.Telegram && window.Telegram.WebApp) {
            const WebApp = window.Telegram.WebApp;

            // 1. Tell Telegram the app is ready (optional but good practice)
            WebApp.ready();

            // 2. Display basic init data (for debugging/context)
            const initDataElement = document.getElementById('tg-init-data');
            if (WebApp.initDataUnsafe && WebApp.initDataUnsafe.user) {
                const user = WebApp.initDataUnsafe.user;
                initDataElement.textContent = `User: ${user.first_name} (@${user.username || 'N/A'}), ID: ${user.id}`;
            } else {
                initDataElement.textContent = "Initialization data available, but user info is restricted.";
            }

            // 3. Handle the button click
            document.getElementById('sendDataButton').addEventListener('click', () => {
                const mockData = {
                    action: 'user_selection',
                    timestamp: new Date().toISOString(),
                    value: 42,
                    user_id: WebApp.initDataUnsafe?.user?.id || 'anonymous'
                };

                // Use WebApp.sendData() to send a string back to the bot
                // The bot receives this data via an update of type web_app_data
                WebApp.sendData(JSON.stringify(mockData));

                // WebApp.sendData automatically closes the Mini App window.
                // If you just wanted to close without sending data, you would use WebApp.close();
            });

            // 4. Set the Main Button visibility
            // This button is usually at the bottom of the Telegram screen and is often better than an in-page button
            // We'll use the in-page button for this example, but here's how you'd use the Main Button:
            /*
            WebApp.MainButton.setText('Confirm Selection');
            WebApp.MainButton.show();
            WebApp.MainButton.onClick(function() {
                // Logic to send data
                WebApp.close();
            });
            */
            
        } else {
            // Fallback for when the app is opened outside of Telegram
            document.getElementById('tg-init-data').textContent = "Telegram Web App script is not available. Please open this link inside Telegram.";
            document.getElementById('sendDataButton').disabled = true;
        }
    </script>
</body>
</html>
